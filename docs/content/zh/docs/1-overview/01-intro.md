---
title: 简介
slug: intro
weight: 1
description: >
  系统简介。
---

由于 BeeFog 在原理上和传统爬虫有一定区别，并且我们是面向开发者的应用，
所以推荐在浏览过系统架构和核心概念后，再进行试用会有更好的效果。

## 系统架构

BeeFog 的系统模块架构如下图所示，其中方块为模块，连线为模块间调用关系。

![架构图](/images/arch.jpg)

### 工作节点 [ Worker Bees ]

- BeeFog 的工作节点可以部署在服务器，PC或手机等各种设备之上。
- 我们会先推出一些独立的 Worker，后续还会推出 SDK，供应用轻松的集成。
- 工作节点的行为是完全主动的，在自己有空闲时，会向控制中心请求任务。
- 在完成任务后，会将结果状态报告给控制中心。报告时也可能根据任务配置携带结果数据。
- 任务执行会有时间限制，在超时后，控制器会将任务分给别的节点执行，不再接收此次任务的结果报告。

### 控制中心 [ Queen Bee ]

控制中心被分为多个模块。模块之间通过接口 `Interface` 中的函数调用。有几个模块会开放 REST API 供外界调用。

#### 工作节点管理器 ( Worker Manager )

工作节点通过提供 `节点组 Token` 在管理器注册，换取 `节点 Token` 用以后续其他请求。管理器可以通过 `节点 Token` 辨识并记录所有节点的状态。

#### 任务定义管理 ( Task Manager )

存储和管理任务定义，提供查询、新增、修改和删除任务定义的 REST API 供用户使用。

#### 任务实例管理器 ( Instance Manager )

任务每次被调用，都会产生一个运行实例。实例管理器维护并保存实例整个生命周期的状态。提供调用任务和查看实例状态的 REST API 。

#### 自动触发管理 ( Trigger Manager )

任务除了使用接口直接调用，还可以预设一定的规则去触发，比如定时触发或根据云端的一个文件状态去触发等等。本模块管理触发规则并实施触发。

#### 任务池 ( Pool )

被调用或触发的任务实例将进入任务池，在有工作节点请求任务时会被按照一定的规则分配给工作节点执行。

#### 结果接收 ( Result Handler )

提供接口接收工作节点报告的结果。如果任务没有 Queen 端需要执行的步骤，则直接将结果报告给实例管理器。
如果有 Queen 端需要执行的步骤，将交给 Queen 端步骤执行器。

#### 服务端步骤执行 ( Queen Steps Runner )

执行需要在 Queen 端执行的步骤，完成后将最终结果报告给实例管理器。

## 基础设施

我们使用了以下基础设施：
- Mysql 用以数据存储
- Redis 用以缓存
- NSQ 用以事件发布和监听
